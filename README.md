# testify


## Что такое testify?
Это небольшое приложение, которое использует аутентификацию при помощи JWT токенов, имеет свое REST API, позволяет получать данные о погоде в определенном городе за определенную дату **(необходим платный API ключ по подписке с сервиса OpenWeatherMap)**, а также предоставляет функционал получения инфомации о памяти локальной машины, посредствам отправки запроса к отдельному скрипту на python.

## Стек

Приложение реализовано на стеке, включающем в себя следующие технологии:
- Для реализации приложения использован Django
- API разработано при помощи Django Rest Framework
- Для запуска скрипта-демона на Python используется web.py
- JWT аутентификация реализована при помощи SimpleJWT
- Приложение разворачивается на Uvicorn

## Принцип работы

Весь проект поделен на 3 приложения, так как у каждого из них имеется очень разобщенный функционал:
- Clients. Приложение, которое использует JWT аутентиикацию, и предоставляет API для работы с записями о клиентах.
- Weather. Приложение, позволяющее получать данные о погоде по названию города и дате **(необходим платный API ключ, использована заглушка)**.
- Memory. Приложение, работающее в связке с демоном (файл *script.py*), которое дает информацию о памяти на локальной машине в процентах.

### Clients

Данное приложение имеет две модели: Client и ClientImage. В первой модели хранится вся информацию о клиенте, а во втором - фото клиента, которое можно обрезать при загрузке. Обе модели связаны друг с другом.

На данных моделях основаны два сериализатора, которые используются Django Rest Framework для работы через API. Один сериализатор включает в себя другой, таким образом делая работу с записями обеих моделей очень удобной и простой.

Все представления основаны на классе, который автоматически генерирует представления для всех действий, которые могут быть совершены с данными записями через REST API (CREATE/GET/UPDATE/DELETE)

Структура API данного приложения:
- api/clients/ - [GET] список всех клиентов
- api/clients/ - [POST] добавление нового клиента
- api/clients/<id>/ - [GET] получение информации об имеющимся клиенте
- api/clients/<id>/ - [UPDATE/PATCH] обновление инфорацмии об имеющимся клиенте
- api/clients/<id>/ - [DELETE] удаление клиента

Кроме того, для аутентификации через JWT используются следующие пути:
- api/token/ - [GET] получение пары Access + Refresh ключей
- api/token/refresh/ - [POST[ обновление JWT токена
- api/token/verify/ - [POST] для подтверждения токенов

### Weather
Простое приложение, которое при помощи 1 представления и 1 формы позволяет пользователю вводить данные о городе и дате, и получать по ним JSON ответ от сервиса погоды. **Для полноценной работы необходима подписка на сервис. В данный момент используется API ключ заглушка, из-за чего информацию о погоде получить не удастся.**

Структура приложения:
weather/ - предоставляет форму для ввода данных при пустом GET запросе. При передаче GET параметров, проводится валидация формы. При успешной валидации, возвращается ответ с сервиса погоды. При не успешной валидации - снова выводится форма.

### Memory
Приложение состоящее из 1 представления, позволяющее получать информацию о памяти на локальной машине через демона на Python. Скрипт, который и является демоном находится в файле *script.py*, который предварительно нужно запустить. Он работает на веб-сервере (отдельно от Django), на фреймворке web.py. Сам скрипт при поступлении запроса на адрес сервера, возвращает информацию о текущем состоянии памяти и предыдущих запросах по ней. Представление же просто отправляет запрос к данному серверу, и возвращает ответ с него.


## Запуск проекта

Для запуска проекта необходимо выполнить следующие действия:

1. Клонировать репозиторий - ```git clone https://github.com/uncelry/testify.git```
2. В папке с проектом создать виртуальное окружение - ```python -m venv venv```
3. Активировать окружение - ```cd venv/Scripts/``` + ```activate```
4. Установить зависимости из requirements.txt - ```pip install -r requirements.txt```
5. Запустить локальный веб-сервер web.py скрипта-демона - ```python script.py 1234```
5. Запустить локальный сервер Uvicorn - ```uvicorn testify.asgi:application --port 80 --no-access-log```
